{"ast":null,"code":"import _regeneratorRuntime from \"/home/chili_666/projects/reisen/richard-reisen/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/home/chili_666/projects/reisen/richard-reisen/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nvar _jsxFileName = \"/home/chili_666/projects/reisen/richard-reisen/src/components/pages/Reisen.js\";\nimport React from \"react\";\nimport Strapi from \"strapi-sdk-javascript/build/main\";\nimport FilterTrips from \"../FilterTrips\";\nimport TripsDetail from \"../TripsDetail\";\nimport TripCard from \"../TripCard\";\nimport Cookie from \"js-cookie\";\nimport { setCart, getCart, getToken } from \"../utils\";\nconst apiUrl = 'https://strapi.luis-backt-und-kocht.de'; //const apiUrl = `${process.env.REACT_APP_BACKEND_URL}`\n\nconst strapi = new Strapi(apiUrl); //console.log(\"URL\", apiUrl)\n//console.log(\"strapi\", strapi+'/graphql'\n\nclass Reisen extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      trips: [],\n      loading: true,\n      token: \"\",\n      cart: [],\n      filter: 0,\n      filteredTrips: [],\n      filtered: false\n    };\n    this.handler = this.handler.bind(this);\n  }\n\n  componentDidMount() {\n    var _this = this;\n\n    return _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n      var request, response;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) switch (_context.prev = _context.next) {\n          case 0:\n            _context.prev = 0;\n\n            /*const response = await strapi.request('POST', '/graphql', {\n              data: {\n                query: `query { trips {\n                    title\n                    id\n            trip_dates {\n            departure\n            return\n            }\n            short_description\n            long_description\n            pics {\n            name\n            url\n            }\n            priceAdult\n            priceReduced\n            flags {\n            flagName\n            id\n            }\n            length\n            }}`\n              }\n                 });*/\n            request = new XMLHttpRequest();\n            _context.next = 4;\n            return fetch('https://strapi.luis-backt-und-kocht.de/trips').then(response => response.json());\n\n          case 4:\n            response = _context.sent;\n            console.log(\"response\", response);\n\n            _this.setState({\n              trips: response,\n              loading: false,\n              token: Cookie.get('jwt'),\n              cart: getCart('cart')\n            });\n\n            _context.next = 12;\n            break;\n\n          case 9:\n            _context.prev = 9;\n            _context.t0 = _context[\"catch\"](0);\n            console.error(_context.t0);\n\n          case 12:\n            ;\n\n          case 13:\n          case \"end\":\n            return _context.stop();\n        }\n      }, _callee, null, [[0, 9]]);\n    }))();\n  }\n\n  handler(val) {\n    var _this2 = this;\n\n    return _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2() {\n      var filtering, filterTrips, i, x;\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) switch (_context2.prev = _context2.next) {\n          case 0:\n            _context2.next = 2;\n            return _this2.setState({\n              filter: val,\n              filtered: true,\n              filteredTrips: []\n            });\n\n          case 2:\n            filterTrips = [];\n\n            if (_this2.state.loading != true) {\n              if (_this2.state.filter > 0) {\n                for (i = 0; i < _this2.state.trips.length; i++) {\n                  for (x = 0; x < _this2.state.trips[i].flags.length; x++) {\n                    if (_this2.state.trips[i].flags[x].id === _this2.state.filter) {\n                      filtering = _this2.state.trips[i];\n                      filterTrips.push(filtering);\n                    }\n                  }\n                }\n              }\n            }\n\n            _this2.setState({\n              filteredTrips: filterTrips\n            });\n\n          case 5:\n          case \"end\":\n            return _context2.stop();\n        }\n      }, _callee2);\n    }))();\n  }\n\n  render() {\n    const filterTrips = this.state.loading ? \"Loading\" : /*#__PURE__*/React.createElement(FilterTrips, {\n      count: this.state.trips.length,\n      handler: this.handler,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 108,\n        columnNumber: 62\n      }\n    });\n    let tripCards;\n\n    if (this.state.filter === 0) {\n      tripCards = this.state.loading ? \"Loading...\" : this.state.trips.map(trip => /*#__PURE__*/React.createElement(TripCard, {\n        key: trip.id,\n        title: trip.title,\n        name: trip.tripName,\n        hero: \"\".concat(apiUrl).concat(trip.pics[0].url) //    hero={`https://strapi.luis.backt-und-kocht.de/${trip.pics[0].url}`\n        ,\n        desc: trip.short_description,\n        length: trip.length,\n        departure: trip.trip_dates[0].departure,\n        return: trip.trip_dates[0].return,\n        id: trip.id,\n        flag: trip.flags,\n        seats: trip.seats,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 112,\n          columnNumber: 11\n        }\n      }));\n      console.log(\"OHNE FILTER\");\n    } else {\n      if (this.state.filter != 0) {\n        tripCards = this.state.loading ? \"Loading...\" : this.state.filteredTrips.map(trip => /*#__PURE__*/React.createElement(\"div\", {\n          className: \"column is-one\",\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 131,\n            columnNumber: 13\n          }\n        }, /*#__PURE__*/React.createElement(TripCard, {\n          key: trip.id,\n          title: trip.title,\n          name: trip.tripName,\n          hero: \"\".concat(apiUrl).concat(trip.pics[0].url) //    hero={`https://strapi.luis.backt-und-kocht.de/${trip.pics[0].url}`\n          ,\n          desc: trip.short_description,\n          length: trip.length,\n          departure: trip.trip_dates[0].departure,\n          return: trip.trip_dates[0].return,\n          id: trip.id,\n          flag: trip.flags,\n          seats: trip.seats,\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 131,\n            columnNumber: 44\n          }\n        })));\n      }\n    }\n\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: \"container is-fluid\",\n      style: {\n        paddingTop: \"2em\"\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 149,\n        columnNumber: 9\n      }\n    }, filterTrips, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"box has-background-white\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 151,\n        columnNumber: 5\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"columns is-multiline\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 153,\n        columnNumber: 5\n      }\n    }, this.state.loading ? \"LÄDT\" : tripCards)));\n  }\n\n}\n\nexport default Reisen;","map":{"version":3,"sources":["/home/chili_666/projects/reisen/richard-reisen/src/components/pages/Reisen.js"],"names":["React","Strapi","FilterTrips","TripsDetail","TripCard","Cookie","setCart","getCart","getToken","apiUrl","strapi","Reisen","Component","constructor","props","state","trips","loading","token","cart","filter","filteredTrips","filtered","handler","bind","componentDidMount","request","XMLHttpRequest","fetch","then","response","json","console","log","setState","get","error","val","filterTrips","i","length","x","flags","id","filtering","push","render","tripCards","map","trip","title","tripName","pics","url","short_description","trip_dates","departure","return","seats","paddingTop"],"mappings":"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","sourcesContent":["import React from \"react\"\nimport Strapi from \"strapi-sdk-javascript/build/main\"\nimport FilterTrips from \"../FilterTrips\";\nimport TripsDetail from \"../TripsDetail\"\nimport TripCard from \"../TripCard\";\nimport Cookie from \"js-cookie\";\nimport {setCart, getCart, getToken } from \"../utils\";\n\nconst apiUrl= 'https://strapi.luis-backt-und-kocht.de';\n//const apiUrl = `${process.env.REACT_APP_BACKEND_URL}`\nconst strapi = new Strapi(apiUrl);\n//console.log(\"URL\", apiUrl)\n//console.log(\"strapi\", strapi+'/graphql'\n\nclass Reisen extends React.Component {\n\n    constructor(props) {\n        super(props)\n    \n        this.state = {\n          trips : [],\n          loading: true,\n          token: \"\",\n          cart: [],\n          filter: 0,\n          filteredTrips: [],\n          filtered: false\n        }\n        this.handler = this.handler.bind(this)\n      }\n    \n     \n    \n      async componentDidMount() {\n        try{\n            /*const response = await strapi.request('POST', '/graphql', {\n              data: {\n                query: `query { trips {\n                    title\n                    id\n      trip_dates {\n        departure\n        return\n      }\n      short_description\n      long_description\n      pics {\n        name\n        url\n      }\n      priceAdult\n      priceReduced\n      flags {\n          flagName\n          id\n      }\n      length\n    }}`\n              }\n    \n            });*/\n        var request = new XMLHttpRequest()\n        const response = await fetch('https://strapi.luis-backt-und-kocht.de/trips')\n         .then ((response) => response.json())\n         console.log(\"response\", response)\n            this.setState({ \n              trips: response,\n              loading: false,\n            token: Cookie.get('jwt'),\n          cart: getCart('cart')})\n        } catch(err) {\n          console.error(err) };\n    \n        }\n      \n      async handler(val) {\n        await this.setState({\n          filter: val,\n          filtered: true,\n          filteredTrips: []\n        })\n       let filtering\n        let filterTrips = []\n        if (this.state.loading != true) {\n          if (this.state.filter > 0 ) {\n          for (let i = 0; i < this.state.trips.length; i++) {\n            for (let x = 0; x < this.state.trips[i].flags.length; x++ ) {\n              \n              if (this.state.trips[i].flags[x].id === this.state.filter) {\n               filtering = this.state.trips[i] \n               filterTrips.push(filtering)\n              \n              }\n            }\n          \n            }\n            \n            \n            \n          }\n        }\n        this.setState({\n          filteredTrips: filterTrips})\n      }\n       \n    \n    render(){\n        const filterTrips = this.state.loading ? \"Loading\" : <FilterTrips count={this.state.trips.length} handler = {this.handler}/>\n        let tripCards\n        if (this.state.filter === 0) {\n        tripCards = this.state.loading ? \"Loading...\" : this.state.trips.map(trip => (\n          <TripCard \n                key={trip.id}\n                title={trip.title} \n                name={trip.tripName}\n                hero={`${apiUrl}${trip.pics[0].url}`} \n            //    hero={`https://strapi.luis.backt-und-kocht.de/${trip.pics[0].url}`\n                desc={trip.short_description} \n                length={trip.length} \n                departure={trip.trip_dates[0].departure} \n                return={trip.trip_dates[0].return}\n                id={trip.id}\n                flag={trip.flags}\n                seats={trip.seats}/>\n        ))\n        console.log(\"OHNE FILTER\")\n        } else {\n          if (this.state.filter != 0) {\n            \n          tripCards = this.state.loading ? \"Loading...\" : this.state.filteredTrips.map(trip => (\n            <div className=\"column is-one\"><TripCard \n                  key={trip.id}\n                  title={trip.title} \n                  name={trip.tripName}\n                  hero={`${apiUrl}${trip.pics[0].url}`} \n              //    hero={`https://strapi.luis.backt-und-kocht.de/${trip.pics[0].url}`\n                  desc={trip.short_description} \n                  length={trip.length} \n                  departure={trip.trip_dates[0].departure} \n                  return={trip.trip_dates[0].return}\n                  id={trip.id}\n                  flag={trip.flags}\n                  seats={trip.seats}/>\n                  </div>\n          ))\n          }\n        } \n    return(  \n        <div className=\"container is-fluid\" style={{paddingTop:\"2em\"}}>\n    {filterTrips}\n    <div className=\"box has-background-white\">\n    \n    <div className=\"columns is-multiline\">\n    \n    {this.state.loading ? \"LÄDT\": tripCards}\n     \n       </div>\n       </div>\n       </div>\n       )\n      \n    }\n}\n\nexport default Reisen"]},"metadata":{},"sourceType":"module"}
{"ast":null,"code":"import _regeneratorRuntime from \"/home/chili_666/projects/reisen/richard-reisen/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/home/chili_666/projects/reisen/richard-reisen/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nvar _jsxFileName = \"/home/chili_666/projects/reisen/richard-reisen/src/components/MeinKonto.js\";\nimport React from \"react\";\nimport BookingDetails from \"./booking/BookingDetails\";\nimport AccountAdress from \"./account/AccountAdress\";\nimport Companion from \"./booking/Companions\";\nimport BookingAddServices from \"./booking/BookingAddServices\";\nimport BookingButton from \"./booking/BookingButton\";\nimport { getToken } from \"./utils\";\nimport Cookie from \"js-cookie\";\nimport Strapi from \"strapi-sdk-javascript/build/main\";\nimport { GiConsoleController } from \"react-icons/gi\";\nconst apiUrl = 'https://strapi.luis-backt-und-kocht.de'; //const apiUrl = `${process.env.REACT_APP_BACKEND_URL}`\n\nconst strapi = new Strapi(apiUrl); //console.log(\"URL\", apiUrl)\n//console.log(\"strapi\", strapi+'/graphql'\n\nclass MeinKonto extends React.Component {\n  constructor() {\n    super();\n    this.state = {\n      companions: false,\n      accountKeys: [],\n      token: null,\n      user: null\n    };\n  }\n\n  componentDidMount() {\n    this.setState({\n      token: Cookie.get('jwt')\n    });\n    console.log(\"ME_STATE_TOKEN\", Cookie.get('jwt'), this.state.token);\n\n    if (this.state.token !== null) {\n      // authenticate the token on the server and place set user object\n      fetch('https://strapi.luis-backt-und-kocht.de/users/me', {\n        headers: {\n          Authorization: \"Bearer \".concat(this.state.token)\n        }\n      }).then( /*#__PURE__*/function () {\n        var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(res) {\n          var userData;\n          return _regeneratorRuntime.wrap(function _callee$(_context) {\n            while (1) switch (_context.prev = _context.next) {\n              case 0:\n                _context.next = 2;\n                return res.json();\n\n              case 2:\n                userData = _context.sent;\n                console.log(\"ANtwor for MEE\", userData); // if res comes back not valid, token is not valid\n                // delete the token and log the user out on client\n\n                /*  if (!res.ok) {\n                    Cookie.remove(\"token\");\n                    this.setState({ user: null });\n                    return null;\n                  } else {\n                  const user = await res.json();\n                  console.log(\"REsponse for MEEEE\", res.json)\n                  this.setState({user: res.json});}\n                });*/\n\n              case 4:\n              case \"end\":\n                return _context.stop();\n            }\n          }, _callee);\n        }));\n\n        return function (_x) {\n          return _ref.apply(this, arguments);\n        };\n      }());\n    }\n  }\n\n  render() {\n    console.log(\"USERSTATE\", this.state.user);\n    return /*#__PURE__*/React.createElement(\"h1\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 62,\n        columnNumber: 13\n      }\n    }, \"Mein Konto will nicht\");\n  }\n\n}\n\nexport default MeinKonto;","map":{"version":3,"sources":["/home/chili_666/projects/reisen/richard-reisen/src/components/MeinKonto.js"],"names":["React","BookingDetails","AccountAdress","Companion","BookingAddServices","BookingButton","getToken","Cookie","Strapi","GiConsoleController","apiUrl","strapi","MeinKonto","Component","constructor","state","companions","accountKeys","token","user","componentDidMount","setState","get","console","log","fetch","headers","Authorization","then","res","json","userData","render"],"mappings":";;;AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,OAAOC,cAAP,MAA2B,0BAA3B;AACA,OAAOC,aAAP,MAA0B,yBAA1B;AACA,OAAOC,SAAP,MAAsB,sBAAtB;AACA,OAAOC,kBAAP,MAA+B,8BAA/B;AACA,OAAOC,aAAP,MAA0B,yBAA1B;AACA,SAAQC,QAAR,QAAuB,SAAvB;AACA,OAAOC,MAAP,MAAmB,WAAnB;AACA,OAAOC,MAAP,MAAmB,kCAAnB;AACA,SAASC,mBAAT,QAAoC,gBAApC;AAGA,MAAMC,MAAM,GAAE,wCAAd,C,CACA;;AACA,MAAMC,MAAM,GAAG,IAAIH,MAAJ,CAAWE,MAAX,CAAf,C,CACA;AACA;;AAEA,MAAME,SAAN,SAAwBZ,KAAK,CAACa,SAA9B,CAAwC;AACrCC,EAAAA,WAAW,GAAG;AACT;AADS,SAGbC,KAHa,GAGL;AACJC,MAAAA,UAAU,EAAE,KADR;AAEJC,MAAAA,WAAW,EAAE,EAFT;AAGJC,MAAAA,KAAK,EAAE,IAHH;AAIJC,MAAAA,IAAI,EAAE;AAJF,KAHK;AAEZ;;AAQDC,EAAAA,iBAAiB,GAAG;AAChB,SAAKC,QAAL,CAAc;AACVH,MAAAA,KAAK,EAAEX,MAAM,CAACe,GAAP,CAAW,KAAX;AADG,KAAd;AAGAC,IAAAA,OAAO,CAACC,GAAR,CAAY,gBAAZ,EAA8BjB,MAAM,CAACe,GAAP,CAAW,KAAX,CAA9B,EAAiD,KAAKP,KAAL,CAAWG,KAA5D;;AACA,QAAI,KAAKH,KAAL,CAAWG,KAAX,KAAqB,IAAzB,EAA+B;AAC3B;AACAO,MAAAA,KAAK,CAAC,iDAAD,EAAoD;AACvDC,QAAAA,OAAO,EAAE;AACPC,UAAAA,aAAa,mBAAY,KAAKZ,KAAL,CAAWG,KAAvB;AADN;AAD8C,OAApD,CAAL,CAIGU,IAJH;AAAA,4EAIQ,iBAAOC,GAAP;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,uBACmBA,GAAG,CAACC,IAAJ,EADnB;;AAAA;AACEC,gBAAAA,QADF;AAEJR,gBAAAA,OAAO,CAACC,GAAR,CAAY,gBAAZ,EAA8BO,QAA9B,EAFI,CAGJ;AACA;;AACF;;;;;;;;;;AALM;AAAA;AAAA;AAAA;AAAA;AAAA,SAJR;;AAAA;AAAA;AAAA;AAAA;AAmBX;AACI;;AAGHC,EAAAA,MAAM,GAAG;AACLT,IAAAA,OAAO,CAACC,GAAR,CAAY,WAAZ,EAAyB,KAAKT,KAAL,CAAWI,IAApC;AACD,wBAAO;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,+BAAP;AACF;;AA5CqC;;AA+CxC,eAAeP,SAAf","sourcesContent":["import React from \"react\"\nimport BookingDetails from \"./booking/BookingDetails\"\nimport AccountAdress from \"./account/AccountAdress\"\nimport Companion from \"./booking/Companions\"\nimport BookingAddServices from \"./booking/BookingAddServices\"\nimport BookingButton from \"./booking/BookingButton\"\nimport {getToken} from \"./utils\"\nimport Cookie from \"js-cookie\";\nimport Strapi from \"strapi-sdk-javascript/build/main\"\nimport { GiConsoleController } from \"react-icons/gi\"\n\n\nconst apiUrl= 'https://strapi.luis-backt-und-kocht.de';\n//const apiUrl = `${process.env.REACT_APP_BACKEND_URL}`\nconst strapi = new Strapi(apiUrl);\n//console.log(\"URL\", apiUrl)\n//console.log(\"strapi\", strapi+'/graphql'\n\nclass MeinKonto extends React.Component {\n   constructor() {\n        super()\n    }\n    state = {\n        companions: false,\n        accountKeys: [],\n        token: null,\n        user: null\n    }\n  \n    componentDidMount() {\n        this.setState({\n            token: Cookie.get('jwt') \n        })\n        console.log(\"ME_STATE_TOKEN\", Cookie.get('jwt'), this.state.token)\n        if (this.state.token !== null) {\n            // authenticate the token on the server and place set user object\n            fetch('https://strapi.luis-backt-und-kocht.de/users/me', {\n              headers: {\n                Authorization: `Bearer ${this.state.token}`,\n              },\n            }).then(async (res) => {\n                const userData = await res.json()\n                console.log(\"ANtwor for MEE\", userData)\n                // if res comes back not valid, token is not valid\n                // delete the token and log the user out on client\n              /*  if (!res.ok) {\n                  Cookie.remove(\"token\");\n                  this.setState({ user: null });\n                  return null;\n                } else {\n                const user = await res.json();\n                console.log(\"REsponse for MEEEE\", res.json)\n                this.setState({user: res.json});}\n              });*/\n    })\n}\n    }\n\n\n  render() {\n      console.log(\"USERSTATE\", this.state.user)\n     return <h1>Mein Konto will nicht</h1>\n  }\n}\n\nexport default MeinKonto"]},"metadata":{},"sourceType":"module"}